<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.64">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="shortcut icon" href="/jmeter-dotnet-dsl/favicon.ico"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                    })(window,document,'script','dataLayer','GTM-PHSGKLD');
                    </script><title>User guide | jmeter-dotnet-dsl</title><meta name="description" content="Simple JMeter performance tests API">
    <link rel="preload" href="/jmeter-dotnet-dsl/assets/style-287f3d2a.css" as="style"><link rel="stylesheet" href="/jmeter-dotnet-dsl/assets/style-287f3d2a.css">
    <link rel="modulepreload" href="/jmeter-dotnet-dsl/assets/app-1f3162e2.js"><link rel="modulepreload" href="/jmeter-dotnet-dsl/assets/index.html-250f6eea.js"><link rel="modulepreload" href="/jmeter-dotnet-dsl/assets/index.html-9b59a4df.js"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/index.html-46b1f23c.js" as="script"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/index.html-20640c9f.js" as="script"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/index.html-8ef7e423.js" as="script"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/index.html-7e804f28.js" as="script"><link rel="prefetch" href="/jmeter-dotnet-dsl/assets/404.html-2f3a974e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><!--[--><a href="/jmeter-dotnet-dsl/" class=""><img class="logo" src="/jmeter-dotnet-dsl/logo.svg" alt="jmeter-dotnet-dsl" style="margin-right:0;"><span style="font-size:1.6rem;"> .net</span><!-- Stripped site title from original theme --></a><hr class="vertical-divider"><a class="external-link" href="https://abstracta.github.io/jmeter-java-dsl" rel="noopener noreferrer" target="_blank" aria-label=".java" style="font-size:1.6rem;color:#5599ff;"><!--[--><!--]--><!--[-->.java<!--]--><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a><!--]--></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a aria-current="page" href="/jmeter-dotnet-dsl/guide/" class="router-link-active router-link-exact-active router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/jmeter-dotnet-dsl/support/" class="" aria-label="Support"><!--[--><!--]--> Support <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://abstracta.github.io/jmeter-java-dsl/motivation/" rel="noopener noreferrer" target="_blank" aria-label="Motivation" style=""><!--[--><!--]--><!--[-->Motivation<!--]--><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://discord.gg/WNSn5hqmSd" rel="noopener noreferrer" target="_blank" style=""><!--[--><!--]--><!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/abstracta/jmeter-dotnet-dsl" rel="noopener noreferrer" target="_blank" style=""><!--[--><!--]--><!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a aria-current="page" href="/jmeter-dotnet-dsl/guide/" class="router-link-active router-link-exact-active router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/jmeter-dotnet-dsl/support/" class="" aria-label="Support"><!--[--><!--]--> Support <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://abstracta.github.io/jmeter-java-dsl/motivation/" rel="noopener noreferrer" target="_blank" aria-label="Motivation" style=""><!--[--><!--]--><!--[-->Motivation<!--]--><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://discord.gg/WNSn5hqmSd" rel="noopener noreferrer" target="_blank" style=""><!--[--><!--]--><!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/abstracta/jmeter-dotnet-dsl" rel="noopener noreferrer" target="_blank" style=""><!--[--><!--]--><!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">User guide <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#setup" class="router-link-active router-link-exact-active sidebar-item" aria-label="Setup"><!--[--><!--]--> Setup <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#simple-http-test-plan" class="router-link-active router-link-exact-active sidebar-item" aria-label="Simple HTTP test plan"><!--[--><!--]--> Simple HTTP test plan <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#run-test-at-scale" class="router-link-active router-link-exact-active sidebar-item" aria-label="Run test at scale"><!--[--><!--]--> Run test at scale <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#azure-load-testing" class="router-link-active router-link-exact-active sidebar-item" aria-label="Azure Load Testing"><!--[--><!--]--> Azure Load Testing <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#blazemeter" class="router-link-active router-link-exact-active sidebar-item" aria-label="BlazeMeter"><!--[--><!--]--> BlazeMeter <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#advanced-threads-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Advanced threads configuration"><!--[--><!--]--> Advanced threads configuration <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#thread-ramps-and-holds" class="router-link-active router-link-exact-active sidebar-item" aria-label="Thread ramps and holds"><!--[--><!--]--> Thread ramps and holds <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#test-plan-debugging" class="router-link-active router-link-exact-active sidebar-item" aria-label="Test plan debugging"><!--[--><!--]--> Test plan debugging <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#view-results-tree" class="router-link-active router-link-exact-active sidebar-item" aria-label="View results tree"><!--[--><!--]--> View results tree <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#debug-jmeter-code" class="router-link-active router-link-exact-active sidebar-item" aria-label="Debug JMeter code"><!--[--><!--]--> Debug JMeter code <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#dummy-sampler" class="router-link-active router-link-exact-active sidebar-item" aria-label="Dummy sampler"><!--[--><!--]--> Dummy sampler <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#test-plan-review-un-jmeter-gui" class="router-link-active router-link-exact-active sidebar-item" aria-label="Test plan review un JMeter GUI"><!--[--><!--]--> Test plan review un JMeter GUI <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#reporting" class="router-link-active router-link-exact-active sidebar-item" aria-label="Reporting"><!--[--><!--]--> Reporting <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#log-requests-and-responses" class="router-link-active router-link-exact-active sidebar-item" aria-label="Log requests and responses"><!--[--><!--]--> Log requests and responses <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#response-processing" class="router-link-active router-link-exact-active sidebar-item" aria-label="Response processing"><!--[--><!--]--> Response processing <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#check-for-expected-response" class="router-link-active router-link-exact-active sidebar-item" aria-label="Check for expected response"><!--[--><!--]--> Check for expected response <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#use-part-of-a-response-in-a-subsequent-request-aka-correlation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Use part of a response in a subsequent request (aka correlation)"><!--[--><!--]--> Use part of a response in a subsequent request (aka correlation) <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#regular-expressions-extraction" class="router-link-active router-link-exact-active sidebar-item" aria-label="Regular expressions extraction"><!--[--><!--]--> Regular expressions extraction <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#requests-generation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Requests generation"><!--[--><!--]--> Requests generation <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#loops" class="router-link-active router-link-exact-active sidebar-item" aria-label="Loops"><!--[--><!--]--> Loops <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#iterating-a-fixed-number-of-times" class="router-link-active router-link-exact-active sidebar-item" aria-label="Iterating a fixed number of times"><!--[--><!--]--> Iterating a fixed number of times <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#group-requests" class="router-link-active router-link-exact-active sidebar-item" aria-label="Group requests"><!--[--><!--]--> Group requests <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#csv-as-input-data-for-requests" class="router-link-active router-link-exact-active sidebar-item" aria-label="CSV as input data for requests"><!--[--><!--]--> CSV as input data for requests <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#provide-request-parameters-programmatically-per-request" class="router-link-active router-link-exact-active sidebar-item" aria-label="Provide request parameters programmatically per request"><!--[--><!--]--> Provide request parameters programmatically per request <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#timers" class="router-link-active router-link-exact-active sidebar-item" aria-label="Timers"><!--[--><!--]--> Timers <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#emulate-user-delays-between-requests" class="router-link-active router-link-exact-active sidebar-item" aria-label="Emulate user delays between requests"><!--[--><!--]--> Emulate user delays between requests <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#requests-synchronization" class="router-link-active router-link-exact-active sidebar-item" aria-label="Requests synchronization"><!--[--><!--]--> Requests synchronization <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#protocols" class="router-link-active router-link-exact-active sidebar-item" aria-label="Protocols"><!--[--><!--]--> Protocols <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#http" class="router-link-active router-link-exact-active sidebar-item" aria-label="HTTP"><!--[--><!--]--> HTTP <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#methods-body" class="router-link-active router-link-exact-active sidebar-item" aria-label="Methods &amp; body"><!--[--><!--]--> Methods &amp; body <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#parameters" class="router-link-active router-link-exact-active sidebar-item" aria-label="Parameters"><!--[--><!--]--> Parameters <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#headers" class="router-link-active router-link-exact-active sidebar-item" aria-label="Headers"><!--[--><!--]--> Headers <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#multipart-requests" class="router-link-active router-link-exact-active sidebar-item" aria-label="Multipart requests"><!--[--><!--]--> Multipart requests <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#cookies-caching" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cookies &amp; caching"><!--[--><!--]--> Cookies &amp; caching <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/jmeter-dotnet-dsl/guide/#redirects" class="router-link-active router-link-exact-active sidebar-item" aria-label="Redirects"><!--[--><!--]--> Redirects <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="user-guide" tabindex="-1"><a class="header-anchor" href="#user-guide" aria-hidden="true">#</a> User guide</h1><p>Here we share some tips and examples on how to use the DSL to tackle common use cases.</p><p>Provided examples use <a href="https://nunit.org/" target="_blank" rel="noopener noreferrer">Nunit<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, but you can use other test libraries.</p><p>Explore the DSL in your preferred IDE to discover all available features, and consider reviewing <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl.Tests" target="_blank" rel="noopener noreferrer">existing tests<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for additional examples.</p><p>The .Net DSL currently does not support all use cases supported by the <a href="https://abstracta.github.io/jmeter-java-dsl/" target="_blank" rel="noopener noreferrer">Java Dsl<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, and currently only focuses on a limited set of features that cover the most commonly used cases. If you identify any particular scenario (or JMeter feature) that you need and is not currently supported, or easy to use, <strong>please let us know by <a href="https://github.com/abstracta/jmeter-dotnet-dsl/issues" target="_blank" rel="noopener noreferrer">creating an issue<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></strong> and we will try to implement it as soon as possible. Usually porting JMeter features is quite fast, and porting existing Java DSL features is even faster.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you like this project, <strong>please give it a star ⭐ in <a href="https://github.com/abstracta/jmeter-dotnet-dsl" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>!</strong>. This helps the project be more visible, gain relevance and encourages us to invest more effort in new features.</p></div><p>For an intro to JMeter concepts and components, you can check <a href="http://jmeter.apache.org/usermanual/get-started.html" target="_blank" rel="noopener noreferrer">JMeter official documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="setup" tabindex="-1"><a class="header-anchor" href="#setup" aria-hidden="true">#</a> Setup</h2><p>To use the DSL just include it in your project:</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>dotnet add package Abstracta<span class="token punctuation">.</span>JmeterDsl <span class="token operator">--</span>version 0<span class="token punctuation">.</span>8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p><a href="https://github.com/abstracta/jmeter-dotnet-dsl-sample" target="_blank" rel="noopener noreferrer">Here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> is a sample project in case you want to start one from scratch.</p></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>JMeter .Net DSL uses existing JMeter Java DSL which in turn uses JMeter. JMeter Java DSL and JMeter are Java based tools. So, <strong>Java 8+ is required</strong> for the proper execution of DSL test plans. One option is downloading a JVM from <a href="https://adoptium.net/" target="_blank" rel="noopener noreferrer">Adoptium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> if you don&#39;t have one already.</p></div><h2 id="simple-http-test-plan" tabindex="-1"><a class="header-anchor" href="#simple-http-test-plan" aria-hidden="true">#</a> Simple HTTP test plan</h2><p>To generate HTTP requests just use provided <code>HttpSampler</code>.</p><p>The following example uses 2 threads (concurrent users) that send 10 HTTP GET requests each to <code>http://my.service</code>.</p><p>Additionally, it logs collected statistics (response times, status codes, etc.) to a file (for later analysis if needed) and checks that the response time 99 percentile is less than 5 seconds.</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">//this is just to log details of each request stats</span>
            <span class="token function">JtlWriter</span><span class="token punctuation">(</span><span class="token string">&quot;jtls&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>When working with multiple samplers in a test plan, specify their names (eg: <code>HttpSampler(&quot;home&quot;, &quot;http://my.service&quot;)</code>) to easily check their respective statistics.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>JMeter .Net DSL uses Java for executing JMeter test plans. If you need to tune JVM parameters, for example for specifying maximum heap memory size, you can use <code>EmbeddedJMeterEngine</code> and the <code>JvmArgs</code> method like in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Engines</span><span class="token punctuation">;</span>
<span class="token range operator">..</span><span class="token punctuation">.</span>
<span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
    <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunIn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmbeddedJmeterEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">JvmArgs</span><span class="token punctuation">(</span><span class="token string">&quot;-Xmx4g&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Since JMeter uses <a href="https://logging.apache.org/log4j/2.x/" target="_blank" rel="noopener noreferrer">log4j2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, if you want to control the logging level or output, you can use something similar to this <a href="Abstracta.JmeterDsl.Tests/log4j2.xml">log4j2.xml</a>, using &quot;CopyToOutputDirectory&quot; in the project item, so the file is available in dotnet build output directory as well (check [Abstracta.JmeterDsl.Test/Abstracta.JmeterDsl.Tests.csproj]).</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Depending on the test framework you use, and the way you run your tests, you might be able to see JMeter logs and output in real-time, at the end of the test, or not see them at all. This is not something we can directly control in JMeter DSL, and heavily depends on the dotnet environment and testing framework implementation.</p><p>When using Nunit, to get real-time console output from JMeter you might want to run your tests with something like <code>dotnet test -v n</code> and add the following code to your tests:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token class-name">TextWriter<span class="token punctuation">?</span></span> originalConsoleOut<span class="token punctuation">;</span>

<span class="token comment">// Redirecting output to progress to get live stdout with nunit.</span>
<span class="token comment">// https://github.com/nunit/nunit3-vs-adapter/issues/343</span>
<span class="token comment">// https://github.com/nunit/nunit/issues/1139</span>
<span class="token punctuation">[</span>SetUp<span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    originalConsoleOut <span class="token operator">=</span> Console<span class="token punctuation">.</span>Out<span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">SetOut</span><span class="token punctuation">(</span>TestContext<span class="token punctuation">.</span>Progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">TearDown</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">SetOut</span><span class="token punctuation">(</span>originalConsoleOut<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Keep in mind that you can use .Net programming to modularize and create abstractions which allow you to build complex test plans that are still easy to read, use and maintain. <a href="https://github.com/abstracta/jmeter-java-dsl/issues/26#issuecomment-953783407" target="_blank" rel="noopener noreferrer">Here is an example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> of some complex abstraction built using Java features (you can easily extrapolate to .Net) and the DSL.</p></div><p>Check <a href="#http">HTTP performance testing</a> for additional details while testing HTTP services.</p><h2 id="run-test-at-scale" tabindex="-1"><a class="header-anchor" href="#run-test-at-scale" aria-hidden="true">#</a> Run test at scale</h2><p>Running a load test from one machine is not always enough, since you are limited to the machine&#39;s hardware capabilities. Sometimes, is necessary to run the test using a cluster of machines to be able to generate enough load for the system under test. Currently, the .Net DSL only provides two ways to run tests at scale, but in the future, we plan to support more (<a href="https://abstracta.github.io/jmeter-java-dsl/guide/#run-test-at-scale" target="_blank" rel="noopener noreferrer">as Java DSL does<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). If you are interested in some not yet covered feature, please ask for it by creating an <a href="https://github.com/abstracta/jmeter-dotnet-dsl/issues" target="_blank" rel="noopener noreferrer">issue in the repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="azure-load-testing" tabindex="-1"><a class="header-anchor" href="#azure-load-testing" aria-hidden="true">#</a> Azure Load Testing</h3><p>To use <a href="https://azure.microsoft.com/en-us/products/load-testing/" target="_blank" rel="noopener noreferrer">Azure Load Testing<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to execute your test plans at scale is as easy as including the following package to your project:</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>dotnet add package Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>Azure <span class="token operator">--</span>version 0<span class="token punctuation">.</span>8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>And using the provided engine like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>Azure</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunIn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AzureEngine</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span><span class="token function">GetEnvironmentVariable</span><span class="token punctuation">(</span><span class="token string">&quot;AZURE_CREDS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// AZURE_CREDS=tenantId:clientId:secretId</span>
            <span class="token punctuation">.</span><span class="token function">TestName</span><span class="token punctuation">(</span><span class="token string">&quot;dsl-test&quot;</span><span class="token punctuation">)</span>
            <span class="token comment">/* 
            This specifies the number of engine instances used to execute the test plan. 
            In this case, means that it will run 2(threads in thread group)x2(engines)=4 concurrent users/threads in total. 
            Each engine executes the test plan independently.
            */</span>
            <span class="token punctuation">.</span><span class="token function">Engines</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 
            <span class="token punctuation">.</span><span class="token function">TestTimeout</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>This test is using <code>AZURE_CREDS</code>, a custom environment variable containing <code>tenantId:clientId:clientSecret</code> with proper values for each. Check at <a href="https://portal.azure.com/#view/Microsoft_AAD_IAM/TenantPropertiesBlade" target="_blank" rel="noopener noreferrer">Azure Portal tenant properties<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> the proper tenant ID for your subscription, and follow <a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal" target="_blank" rel="noopener noreferrer">this guide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to register an application with proper permissions and secrets generation for tests execution.</p></blockquote><p>With Azure, you can not only run the test at scale but also get additional features like nice real-time reporting, historic data tracking, etc. Here is an example of how a test looks like in Azure Load Testing:</p><p><img src="/jmeter-dotnet-dsl/assets/azure-35125246.png" alt="Azure Load Testing Example Execution Dashboard"></p><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl.Azure/AzureEngine.cs" target="_blank" rel="noopener noreferrer">AzureEngine<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for details on usage and available settings when running tests in Azure Load Testing.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>By default, the engine is configured to time out if test execution takes more than 1 hour. This timeout exists to avoid any potential problem with Azure Load Testing execution not detected by the client, and avoid keeping the test indefinitely running until is interrupted by a user, which may incur unnecessary expenses in Azure and is especially annoying when running tests in an automated fashion, for example in CI/CD. It is strongly advised to <strong>set this timeout properly in each run</strong>, according to the expected test execution time plus some additional margin (to consider for additional delays in Azure Load Testing test setup and teardown) to avoid unexpected test plan execution failure (due to timeout) or unnecessary waits when there is some unexpected issue with Azure Load Testing execution.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you want to get debug logs for HTTP calls to Azure API, you can include the following setting to an existing <code>log4j2.xml</code> configuration file:</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>us.abstracta.jmeter.javadsl.azure.AzureClient<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>okhttp3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="blazemeter" tabindex="-1"><a class="header-anchor" href="#blazemeter" aria-hidden="true">#</a> BlazeMeter</h3><p>By including the following package:</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>dotnet add package Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>BlazeMeter <span class="token operator">--</span>version 0<span class="token punctuation">.</span>8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You can easily run a JMeter test plan at scale in <a href="https://www.blazemeter.com/" target="_blank" rel="noopener noreferrer">BlazeMeter<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>BlazeMeter</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token comment">// number of threads and iterations are in the end overwritten by BlazeMeter engine settings </span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunIn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BlazeMeterEngine</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span><span class="token function">GetEnvironmentVariable</span><span class="token punctuation">(</span><span class="token string">&quot;BZ_TOKEN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">TestName</span><span class="token punctuation">(</span><span class="token string">&quot;DSL test&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">TotalUsers</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">HoldFor</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ThreadsPerEngine</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">TestTimeout</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">TestName</span><span class="token punctuation">(</span><span class="token string">&quot;dsl-test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>This test is using <code>BZ_TOKEN</code>, a custom environment variable with <code>&lt;KEY_ID&gt;:&lt;KEY_SECRET&gt;</code> format, to get the BlazeMeter API authentication credentials.</p></blockquote><p>Note that is as simple as <a href="https://guide.blazemeter.com/hc/en-us/articles/115002213289-BlazeMeter-API-keys-" target="_blank" rel="noopener noreferrer">generating a BlazeMeter authentication token<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and adding <code>.RunIn(new BlazeMeterEngine(...))</code> to any existing JMeter DSL test to get it running at scale in BlazeMeter.</p><p>BlazeMeter will not only allow you to run the test at scale but also provides additional features like nice real-time reporting, historic data tracking, etc. Here is an example of how a test would look in BlazeMeter:</p><p><img src="/jmeter-dotnet-dsl/assets/blazemeter-85d7b816.png" alt="BlazeMeter Example Execution Dashboard"></p><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl.BlazeMeter/BlazeMeterEngine.cs" target="_blank" rel="noopener noreferrer">BlazeMeterEngine<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for details on usage and available settings when running tests in BlazeMeter.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>By default the engine is configured to timeout if test execution takes more than 1 hour. This timeout exists to avoid any potential problem with BlazeMeter execution not detected by the client, and avoid keeping the test indefinitely running until is interrupted by a user, which may incur in unnecessary expenses in BlazeMeter and is specially annoying when running tests in automated fashion, for example in CI/CD. It is strongly advised to <strong>set this timeout properly in each run</strong>, according to the expected test execution time plus some additional margin (to consider for additional delays in BlazeMeter test setup and teardown) to avoid unexpected test plan execution failure (due to timeout) or unnecessary waits when there is some unexpected issue with BlazeMeter execution.</p></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p><code>BlazeMeterEngine</code> always returns 0 as <code>sentBytes</code> statistics since there is no efficient way to get it from BlazMeter.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>By default <code>BlazeMeterEngine</code> will run tests from default location (most of the times <code>us-east4-a</code>). But in some scenarios you might want to change the location, or even run the test from multiple locations.</p><p>Here is an example how you can easily set this up:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">TestPlan</span><span class="token punctuation">(</span>
    <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 300 total users for 5 minutes</span>
      <span class="token function">HttpSampler</span><span class="token punctuation">(</span>SAMPLE_LABEL<span class="token punctuation">,</span> <span class="token string">&quot;https://myservice&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunIn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BlazeMeterEngine</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span><span class="token function">GetEnvironmentVariable</span><span class="token punctuation">(</span><span class="token string">&quot;BZ_TOKEN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Location</span><span class="token punctuation">(</span>BlazeMeterLocation<span class="token punctuation">.</span>GCP_SAO_PAULO<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment">// 30% = 90 users will run in Google Cloud Platform at Sao Paulo</span>
    <span class="token punctuation">.</span><span class="token function">Location</span><span class="token punctuation">(</span><span class="token string">&quot;MyPrivateLocation&quot;</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span> <span class="token comment">// 70% = 210 users will run in MyPrivateLocation named private location</span>
    <span class="token punctuation">.</span><span class="token function">TestTimeout</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>In case you want to get debug logs for HTTP calls to BlazeMeter API, you can include the following setting to an existing <code>log4j2.xml</code> configuration file:</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>us.abstracta.jmeter.javadsl.blazemeter.BlazeMeterClient<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>okhttp3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="advanced-threads-configuration" tabindex="-1"><a class="header-anchor" href="#advanced-threads-configuration" aria-hidden="true">#</a> Advanced threads configuration</h2><p>JMeter DSL provides two simple ways of creating thread groups which are used in most scenarios:</p><ul><li>specifying threads and the number of iterations each thread should execute before ending the test plan</li><li>specifying threads and duration for which each thread should execute before the test plan ends</li></ul><p>This is how they look in code:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">// 10 threads for 20 iterations each</span>
<span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">// 10 threads for 20 seconds each</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>But these options are not good when working with many threads or when trying to configure some complex test scenarios (like when doing incremental or peak tests).</p><h3 id="thread-ramps-and-holds" tabindex="-1"><a class="header-anchor" href="#thread-ramps-and-holds" aria-hidden="true">#</a> Thread ramps and holds</h3><p>When working with many threads, it is advisable to configure a ramp-up period, to avoid starting all threads at once affecting performance metrics and generation.</p><p>You can easily configure a ramp-up with the DSL like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RampTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">HoldIterating</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// ramp to 10 threads for 5 seconds (1 thread every half second) and iterating each thread 20 times</span>
<span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RampToAndHold</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//similar as above but after ramping up holding execution for 20 seconds</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally, you can use and combine these same methods to configure more complex scenarios (incremental, peak, and any other types of tests) like the following one:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">RampToAndHold</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">RampToAndHold</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">RampTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">RampToAndHold</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">RampTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Children</span><span class="token punctuation">(</span>
      <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Which would translate into the following threads&#39; timeline:</p><p><img src="/jmeter-dotnet-dsl/assets/ultimate-thread-group-timeline-471befb4.png" alt="Thread Group Timeline"></p><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/jmeter-java-dsl/src/main/java/us/abstracta/jmeter/javadsl/core/threadgroups/DslThreadGroup.java" target="_blank" rel="noopener noreferrer">DslThreadGroup<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you are a JMeter GUI user, you may even be interested in using provided <code>TestElement.ShowInGui()</code> method, which shows the JMeter test element GUI that could help you understand what will DSL execute in JMeter. You can use this method with any test element generated by the DSL (not just thread groups).</p><p>For example, for the above test plan you would get a window like the following one:</p><p><img src="/jmeter-dotnet-dsl/assets/ultimate-thread-group-gui-400bcb90.png" alt="UltimateThreadGroup GUI"></p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>When using multiple thread groups in a test plan, consider setting a name (eg: <code>ThreadGroup(&quot;main&quot;, 1, 1, ...)</code>) on them to properly identify associated requests in statistics &amp; jtl results.</p></div><h2 id="test-plan-debugging" tabindex="-1"><a class="header-anchor" href="#test-plan-debugging" aria-hidden="true">#</a> Test plan debugging</h2><p>A usual requirement while building a test plan is to be able to review requests and responses and debug the test plan for potential issues in the configuration or behavior of the service under test. With JMeter DSL you have several options for this purpose.</p><h3 id="view-results-tree" tabindex="-1"><a class="header-anchor" href="#view-results-tree" aria-hidden="true">#</a> View results tree</h3><p>One option is using provided <code>ResultsTreeVisualizer()</code> like in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">ResultsTreeVisualizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This will display the JMeter built-in View Results Tree element, which allows you to review request and response contents in addition to collected metrics (spent time, sent &amp; received bytes, etc.) for each request sent to the server, in a window like this one:</p><p><img src="/jmeter-dotnet-dsl/assets/view-results-tree-431a3001.png" alt="View Results Tree GUI"></p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>To debug test plans use a few iterations and threads to reduce the execution time and ease tracing by having less information to analyze.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>When adding <code>ResultsTreeVisualizer()</code> as a child of a thread group, it will only display sample results of that thread group. When added as a child of a sampler, it will only show sample results for that sampler. You can use this to only review certain sample results in your test plan.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p><strong>Remove <code>ResultsTreeVisualizer()</code> from test plans when are no longer needed</strong> (when debugging is finished). Leaving them might interfere with unattended test plan execution (eg: in CI) due to test plan execution not finishing until all visualizers windows are closed.</p></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>By default, View Results Tree only displays the last 500 sample results. If you need to display more elements, use provided <code>ResultsLimit(int)</code> method which allows changing this value. Take into consideration that the more results are shown, the more memory that will require. So use this setting with care.</p></div><h3 id="debug-jmeter-code" tabindex="-1"><a class="header-anchor" href="#debug-jmeter-code" aria-hidden="true">#</a> Debug JMeter code</h3><p>You can even add breakpoints to JMeter or JMeter Java DSL code in your IDE and debug the code line by line providing the greatest possible detail.</p><p>Here is an example screenshot debugging HTTP Sampler:</p><p><img src="/jmeter-dotnet-dsl/assets/jmeter-http-sampler-debugging-ebeea624.png" alt="JMeter HTTP Sampler debugging in IDE"></p><p>For that, you need to:</p><ul><li>have a Java IDE with JMeter or JMeter Java DSL code open.</li><li>set proper breakpoints in the code you are interested in debugging.</li><li>can configure Remote JVM Debug like in the following screenshot: <img src="/jmeter-dotnet-dsl/assets/intellij-remote-jvm-debug-448b6207.png" alt="IntelliJ Remote JVM Debug"></li><li>set required JVM arguments in the JMeter .Net DSL test using <code>EmbeddedJmeterEngine</code> like in the following example:<div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">TestPlan</span><span class="token punctuation">(</span>
      <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token named-parameter punctuation">threads</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">iterations</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunIn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmbeddedJmeterEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">JvmArgs</span><span class="token punctuation">(</span><span class="token string">&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note that we changed the <code>suspend</code> flag to <code>y</code> to block test execution until Remote JVM Debug is run in IDE.</p></blockquote></li><li>run the JMeter .Net DSL test. The test should get stuck until you start Remote JVM Debug in the Java IDE.</li><li>start the Remote JVM Devug in the Java IDE.</li><li>wait for a breakpoint to activate and debug as usual 🙂.</li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>JMeter class in charge of executing threads logic is <code>org.apache.jmeter.threads.JMeterThread</code>. You can check the classes used by each DSL-provided test element by checking the Java DSL code.</p></div><h3 id="dummy-sampler" tabindex="-1"><a class="header-anchor" href="#dummy-sampler" aria-hidden="true">#</a> Dummy sampler</h3><p>In many cases, you want to be able to test part of the test plan but without directly interacting with the service under test, avoiding any potential traffic to the servers, testing some border cases which might be difficult to reproduce with the actual server, and avoid actual server interactions variability and potential unpredictability. In such scenarios, you might replace actual samplers with <code>DummySampler</code> (which uses <a href="https://jmeter-plugins.org/wiki/DummySampler/" target="_blank" rel="noopener noreferrer">Dummy Sampler plugin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) to be able to test extractors, assertions, controllers conditions, and other parts of the test plan under certain conditions/results generated by the samplers.</p><p>Here is an example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token comment">// HttpSampler(&quot;http://my.service&quot;)</span>
                <span class="token function">DummySampler</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;status\&quot; : \&quot;OK\&quot;}&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>The DSL configures dummy samplers by default, in contrast to what JMeter does, with response time simulation disabled. This allows to speed up the debugging process, not having to wait for proper response time simulation (sleeps/waits). If you want a more accurate emulation, you might turn it on through the <code>ResponseTimeSimulation()</code> method.</p></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Samplers/DslDummySampler.cs" target="_blank" rel="noopener noreferrer">DslDummySampler<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more information o additional configuration and options.</p><h3 id="test-plan-review-un-jmeter-gui" tabindex="-1"><a class="header-anchor" href="#test-plan-review-un-jmeter-gui" aria-hidden="true">#</a> Test plan review un JMeter GUI</h3><p>A usual requirement for new DSL users that are used to Jmeter GUI, is to be able to review Jmeter DSL generated test plan in the familiar JMeter GUI. For this, you can use the <code>ShowInGui()</code> method in a test plan to open JMeter GUI with the preloaded test plan.</p><p>This can be also used to debug the test plan, by adding elements (like view results tree, dummy samplers, etc.) in the GUI and running the test plan.</p><p>Here is a simple example using the method:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ShowInGui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Which ends up opening a window like this one:</p><p><img src="/jmeter-dotnet-dsl/assets/test-plan-gui-a4e8b653.png" alt="Test plan in JMeter GUI"></p><h2 id="reporting" tabindex="-1"><a class="header-anchor" href="#reporting" aria-hidden="true">#</a> Reporting</h2><p>Once you have a test plan you would usually want to be able to analyze the collected information. This section contains a few ways to achieve this, but in the future, we plan to support more (<a href="https://abstracta.github.io/jmeter-java-dsl/guide/#reporting" target="_blank" rel="noopener noreferrer">as Java DSL does<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). If you are interested in some not yet covered feature, please ask for it by creating an <a href="https://github.com/abstracta/jmeter-dotnet-dsl/issues" target="_blank" rel="noopener noreferrer">issue in the repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="log-requests-and-responses" tabindex="-1"><a class="header-anchor" href="#log-requests-and-responses" aria-hidden="true">#</a> Log requests and responses</h3><p>The main mechanism provided by JMeter (and <code>Abstracta.JmeterDsl</code>) to get information about generated requests, responses, and associated metrics is through the generation of JTL files.</p><p>This can be easily achieved by using provided <code>JtlWriter</code> like in this example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">JtlWriter</span><span class="token punctuation">(</span><span class="token string">&quot;jtls&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>By default, <code>JtlWriter</code> will write the most used information to evaluate the performance of the tested service. If you want to trace all the information of each request you may use <code>JtlWriter</code> with the <code>WithAllFields()</code> option. Doing this will provide all the information at the cost of additional computation and resource usage (fewer resources for actual load testing). You can tune which fields to include or not with <code>JtlWriter</code> and only log what you need, check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Listeners/JtlWriter.cs" target="_blank" rel="noopener noreferrer">JtlWriter<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p><code>JtlWriter</code> will automatically generate <code>.jtl</code> files applying this format: <code>&lt;yyyy-MM-dd HH-mm-ss&gt; &lt;UUID&gt;.jtl</code>.</p><p>If you need a specific file name, for example for later postprocessing logic (eg: using CI build ID), you can specify it by using <code>JtlWriter(directory, fileName)</code>.</p><p>When specifying the file name, make sure to use unique names, otherwise, the JTL contents may be appended to previous existing jtl files.</p></div><p>An additional option, specially targeted towards logging sample responses, is <code>ResponseFileSaver</code> which automatically generates a file for each received response. Here is an example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">ResponseFileSaver</span><span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;dd-MM-yyyy HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-response&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Listeners/ResponseFileSaver.cs" target="_blank" rel="noopener noreferrer">ResponseFileSaver<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details.</p><h2 id="response-processing" tabindex="-1"><a class="header-anchor" href="#response-processing" aria-hidden="true">#</a> Response processing</h2><h3 id="check-for-expected-response" tabindex="-1"><a class="header-anchor" href="#check-for-expected-response" aria-hidden="true">#</a> Check for expected response</h3><p>By default, JMeter marks any HTTP request with a fail response code (4xx or 5xx) as failed, which allows you to easily identify when some request unexpectedly fails. But in many cases, this is not enough or desirable, and you need to check for the response body (or some other field) to contain (or not) a certain string.</p><p>This is usually accomplished in JMeter with the usage of Response Assertions, which provides an easy and fast way to verify that you get the proper response for each step of the test plan, marking the request as a failure when the specified condition is not met.</p><p>Here is an example of how to specify a response assertion in JMeter DSL:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Children</span><span class="token punctuation">(</span>
                        <span class="token function">ResponseAssertion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ContainsSubstrings</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Assertions/DslResponseAssertion.cs" target="_blank" rel="noopener noreferrer">Response Assertion<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details and additional options.</p><h3 id="use-part-of-a-response-in-a-subsequent-request-aka-correlation" tabindex="-1"><a class="header-anchor" href="#use-part-of-a-response-in-a-subsequent-request-aka-correlation" aria-hidden="true">#</a> Use part of a response in a subsequent request (aka correlation)</h3><p>It is a usual requirement while creating a test plan for an application to be able to use part of a response (e.g.: a generated ID, token, etc.) in a subsequent request. This can be easily achieved using JMeter extractors and variables.</p><h4 id="regular-expressions-extraction" tabindex="-1"><a class="header-anchor" href="#regular-expressions-extraction" aria-hidden="true">#</a> Regular expressions extraction</h4><p>Here is an example with JMeter DSL using regular expressions:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/accounts&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;name\&quot;: \&quot;John Doe\&quot;}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Children</span><span class="token punctuation">(</span>
                        <span class="token function">RegexExtractor</span><span class="token punctuation">(</span><span class="token string">&quot;ACCOUNT_ID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\&quot;id\&quot;:\&quot;([^\&quot;]+)\&quot;&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/accounts/${ACCOUNT_ID}&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/PostProcessors/DslRegexExtractor.cs" target="_blank" rel="noopener noreferrer">DslRegexExtractor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details and additional options.</p><h2 id="requests-generation" tabindex="-1"><a class="header-anchor" href="#requests-generation" aria-hidden="true">#</a> Requests generation</h2><h3 id="loops" tabindex="-1"><a class="header-anchor" href="#loops" aria-hidden="true">#</a> Loops</h3><h4 id="iterating-a-fixed-number-of-times" tabindex="-1"><a class="header-anchor" href="#iterating-a-fixed-number-of-times" aria-hidden="true">#</a> Iterating a fixed number of times</h4><p>In simple scenarios where you just want to execute a fixed number of times, within a thread group iteration, a given part of the test plan, you can just use <code>ForLoopController</code> (which uses <a href="https://jmeter.apache.org/usermanual/component_reference.html#Loop_Controller" target="_blank" rel="noopener noreferrer">JMeter Loop Controller component<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) as in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">ForLoopController</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/accounts&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This will result in 10 * 5 = 50 requests to the given URL for each thread in the thread group.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>JMeter automatically generates a variable <code>__jm__&lt;loopName&gt;__idx</code> with the current index of for loop iteration (starting with 0) which you can use in children elements. The default name for the for loop controller, when not specified, is <code>for</code>.</p></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Controllers/ForLoopController.cs" target="_blank" rel="noopener noreferrer">ForLoopController<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details.</p><h3 id="group-requests" tabindex="-1"><a class="header-anchor" href="#group-requests" aria-hidden="true">#</a> Group requests</h3><p>Sometimes, is necessary to be able to group requests which constitute different steps in a test. For example, to separate necessary requests to do a login from the ones used to add items to the cart and the ones to do a purchase. JMeter (and the DSL) provide Transaction Controllers for this purpose, here is an example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestTransactions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/login&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;user=test&amp;password=test&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>FormUrlEncoded<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;checkout&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/items&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/cart/items&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">poPostst</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;id\&quot;: 1}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This will provide additional sample results for each transaction, which contain the aggregate metrics for containing requests, allowing you to focus on the actual flow steps instead of each particular request.</p><p>If you don&#39;t want to generate additional sample results (and statistics), and want to group requests for example to apply a given timer, config, assertion, listener, pre- or post-processor, then you can use <code>SimpleController</code> like in following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestTransactions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">simpleController</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/users&quot;</span><span class="token punctuation">)</span>
                    <span class="token function">ResponseAssertion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">ContainsSubstrings</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can even use <code>TransactionController</code> and <code>SimpleController</code> to easily modularize parts of your test plan into Java methods (or classes) like in this example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token return-type class-name">DslTransactionController</span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> baseUrl<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
            <span class="token function">HttpSampler</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">HttpSampler</span><span class="token punctuation">(</span>baseUrl <span class="token operator">+</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;user=test&amp;password=test&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>FormUrlEncoded<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name">DslTransactionController</span> <span class="token function">AddItemToCart</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> baseUrl<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;addItemToCart&quot;</span><span class="token punctuation">,</span>
            <span class="token function">HttpSampler</span><span class="token punctuation">(</span>baseUrl <span class="token operator">+</span> <span class="token string">&quot;/items&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">HttpSampler</span><span class="token punctuation">(</span>baseUrl <span class="token operator">+</span> <span class="token string">&quot;/cart/items&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;id\&quot;: 1}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestTransactions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> baseUrl <span class="token operator">=</span> <span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">;</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">Login</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">AddItemToCart</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="csv-as-input-data-for-requests" tabindex="-1"><a class="header-anchor" href="#csv-as-input-data-for-requests" aria-hidden="true">#</a> CSV as input data for requests</h3><p>Sometimes is necessary to run the same flow but using different pre-defined data on each request. For example, a common use case is to use a different user (from a given set) in each request.</p><p>This can be easily achieved using the provided <code>CsvDataSet</code> element. For example, having a file like this one:</p><div class="language-csv line-numbers-mode" data-ext="csv"><pre class="language-csv"><code><span class="token value">USER</span><span class="token punctuation">,</span><span class="token value">PASS</span>
<span class="token value">user1</span><span class="token punctuation">,</span><span class="token value">pass1</span>
<span class="token value">user2</span><span class="token punctuation">,</span><span class="token value">pass2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can implement a test plan that tests recurrent login with the two users with something like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">CsvDataSet</span><span class="token punctuation">(</span><span class="token string">&quot;users.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/login&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;${USER}\&quot;: \&quot;${PASS}\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/logout&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span>HttpMethod<span class="token punctuation">.</span>Post<span class="token punctuation">.</span>Method<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>To properly format the data in your CSV, a general rule you can apply is to replace each double quotes with two double quotes and add double quotes to the beginning and end of each CSV value.</p><p>E.g.: if you want one CSV field to contain the value <code>{&quot;field&quot;: &quot;value&quot;}</code>, then use <code>&quot;{&quot;&quot;field:&quot;&quot;: &quot;&quot;value&quot;&quot;}&quot;</code>.</p><p>This way, with a simple search and replace, you can include in a CSV field any format like JSON, XML, etc.</p><p>Note: JMeter uses should be aware that JMeter DSL <code>CsvDataSet</code> sets <code>Allowed quoted data?</code> flag, in associated <code>Csv Data Set Config</code> element, to <code>true</code>.</p></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>By default, the CSV file will be opened once and shared by all threads. This means that when one thread reads a CSV line in one iteration, then the following thread reading a line will continue with the following line.</p><p>If you want to change this (to share the file per thread group or use one file per thread), then you can use the provided <code>SharedIn</code> method like in the following example:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>using <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Configs<span class="token punctuation">.</span>DslCsvDataSet</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">var</span> stats <span class="token operator">=</span> <span class="token class-name">TestPlan</span><span class="token punctuation">(</span>
        <span class="token class-name">CsvDataSet</span><span class="token punctuation">(</span><span class="token string">&quot;users.csv&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">SharedIn</span><span class="token punctuation">(</span><span class="token class-name">Sharing<span class="token punctuation">.</span>Thread</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token class-name">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/login&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;${USER}\&quot;: \&quot;${PASS}\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span><span class="token class-name">MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/logout&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod<span class="token punctuation">.</span>Post<span class="token punctuation">.</span>Method</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Assert<span class="token punctuation">.</span>That</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">stats<span class="token punctuation">.</span></span>Overall<span class="token punctuation">.</span>SampleTimePercentile99</span><span class="token punctuation">,</span> <span class="token class-name">Is<span class="token punctuation">.</span>LessThan</span><span class="token punctuation">(</span><span class="token class-name">TimeSpan<span class="token punctuation">.</span>FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>You can use the <code>RandomOrder()</code> method to get CSV lines in random order (using <a href="https://github.com/Blazemeter/jmeter-bzm-plugins/blob/master/random-csv-data-set/RandomCSVDataSetConfig.md" target="_blank" rel="noopener noreferrer">Random CSV Data Set plugin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>), but this is less performant as getting them sequentially, so use it sparingly.</p></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/Configs/DslCsvDataSet.cs" target="_blank" rel="noopener noreferrer">DslCsvDataSet<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for additional details and options (like changing delimiter, handling files without headers line, stopping on the end of file, etc.).</p><h3 id="provide-request-parameters-programmatically-per-request" tabindex="-1"><a class="header-anchor" href="#provide-request-parameters-programmatically-per-request" aria-hidden="true">#</a> Provide request parameters programmatically per request</h3><p>So far we have seen a how to generate requests with information extracted from CSV, but this is not enough for some scenarios. When you need more flexibility and power you can use <code>jsr223preProcessor</code> to specify your own logic to build each request.</p><p>Here is an example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;${REQUEST_BODY}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Plain<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Children</span><span class="token punctuation">(</span><span class="token function">Jsr223PreProcessor</span><span class="token punctuation">(</span><span class="token string">&quot;vars.put(&#39;REQUEST_BODY&#39;, &#39;{\&quot;time\&quot;: \&quot;&#39; + Instant.now() + &#39;\&quot;}&#39;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>Overall<span class="token punctuation">.</span>SampleTimePercentile99<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>For the time being only JSR223 scripts can be used. By default <code>Groovy</code> is used, but you can change to others by using the provided <code>Language()</code> method.</p><p>We plan in the future to look for alternatives as to be able to use .Net code as pre processor. If you are interested in this you can let us know in <a href="https://github.com/abstracta/jmeter-dotnet-dsl/issues/3" target="_blank" rel="noopener noreferrer">this issue<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> posting your use case.</p></div><p>Check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Core/PreProcessors/DslJsr223PreProcessor.cs" target="_blank" rel="noopener noreferrer">DslJsr223PreProcessor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for more details and additional options.</p><h3 id="timers" tabindex="-1"><a class="header-anchor" href="#timers" aria-hidden="true">#</a> Timers</h3><h4 id="emulate-user-delays-between-requests" tabindex="-1"><a class="header-anchor" href="#emulate-user-delays-between-requests" aria-hidden="true">#</a> Emulate user delays between requests</h4><p>Sometimes, is necessary to be able to properly replicate users&#39; behavior, and in particular the time the users take between sending one request and the following one. For example, to simulate the time it will take to complete a purchase form. JMeter (and the DSL) provide a few alternatives for this.</p><p>If you just want to add 1 pause between two requests, you can use the <code>ThreadPause</code> method like in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/items&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">ThreadPause</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/cart/selected-items&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;id\&quot;: 1}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Using <code>ThreadPause</code> is a good solution for adding individual pauses, but if you want to add pauses across several requests, or sections of test plan, then using a <code>ConstantTimer</code> or <code>UniformRandomTimer</code> is better. Here is an example that adds a delay of between 4 and 10 seconds for every request in the test plan:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token function">UniformRandomTimer</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;addItemToCart&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/items&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/cart/selected-items&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;id\&quot;: 1}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">Transaction</span><span class="token punctuation">(</span><span class="token string">&quot;checkout&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/cart/chekout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/cart/checkout/userinfo&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">poPostst</span><span class="token punctuation">(</span>
                            <span class="token string">&quot;{\&quot;Name\&quot;: Dave, \&quot;lastname\&quot;: Tester, \&quot;Street\&quot;: 1483  Smith Road, \&quot;City\&quot;: Atlanta}&quot;</span><span class="token punctuation">,</span>
                            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>As you may have noticed, timer order in relation to samplers, doesn&#39;t matter. Timers apply to all samplers in their scope, adding a pause after pre-processor executions and before the actual sampling. <code>ThreadPause</code> order, on the other hand, is relevant, and the pause will only execute when previous samplers in the same scope have run and before following samplers do.</p></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p><code>UniformRandomTimer</code> <code>minimum</code> and <code>maximum</code> parameters differ from the ones used by JMeter Uniform Random Timer element, to make it simpler for users with no JMeter background.</p><p>The generated JMeter test element uses the <code>Constant Delay Offset</code> set to <code>minimum</code> value, and the <code>Maximum random delay</code> set to <code>(maximum - minimum)</code> value.</p></div><h4 id="requests-synchronization" tabindex="-1"><a class="header-anchor" href="#requests-synchronization" aria-hidden="true">#</a> Requests synchronization</h4><p>Usually, samples generated by different threads in a test plan thread group start deviating from each other according to the different durations each of them may experience.</p><p>Here is a diagram depicting this behavior, extracted from <a href="https://github.com/abstracta/jmeter-java-dsl/discussions/204" target="_blank" rel="noopener noreferrer">this nice example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> provided by one of JMeter DSL users:</p><p><img src="/jmeter-dotnet-dsl/assets/not-synchronized-samples-483d50c1.png" alt="not synchronized samples in 2 threads and 3 iterations"></p><p>In most cases this is ok. But, if you want to generate batches of simultaneous requests to a system under test, this variability will prevent you from getting the expected behavior.</p><p>So, to synchronize requests, by holding some of them until all are in sync, like in this diagram:</p><p><img src="/jmeter-dotnet-dsl/assets/synchronized-samples-3256a15e.png" alt="synchronized samples in 2 threads and 3 iterations"></p><p>You can use <code>SynchronizingTimer</code> like in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">TestPlan</span><span class="token punctuation">(</span>
    <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token function">HttpSample</span><span class="token punctuation">(</span><span class="token string">&quot;https://mysite&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">SynchronizingTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="protocols" tabindex="-1"><a class="header-anchor" href="#protocols" aria-hidden="true">#</a> Protocols</h2><h3 id="http" tabindex="-1"><a class="header-anchor" href="#http" aria-hidden="true">#</a> HTTP</h3><p>Throughout this guide, several examples have been shown for simple cases of HTTP requests (mainly how to do gets and posts), but the DSL provides additional features that you might need to be aware of.</p><p>Here we show some of them, but check <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/JmeterDsl.cs" target="_blank" rel="noopener noreferrer">JmeterDsl<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and <a href="https://github.com/abstracta/jmeter-dotnet-dsl/tree/master/Abstracta.JmeterDsl/Http/DslHttpSampler.cs" target="_blank" rel="noopener noreferrer">DslHttpSampler<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to explore all available features.</p><h4 id="methods-body" tabindex="-1"><a class="header-anchor" href="#methods-body" aria-hidden="true">#</a> Methods &amp; body</h4><p>As previously seen, you can do simple gets and posts like in the following snippet:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span> <span class="token comment">// A simple get</span>
<span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;field\&quot;:\&quot;val\&quot;}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// simple post</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>But you can also use additional methods to specify any HTTP method and body:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span>HttpMethod<span class="token punctuation">.</span>Put<span class="token punctuation">.</span>Method<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">ContentType</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Body</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;field\&quot;:\&quot;val\&quot;}&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="parameters" tabindex="-1"><a class="header-anchor" href="#parameters" aria-hidden="true">#</a> Parameters</h4><p>In many cases, you will need to specify some URL query string parameters or URL encoded form bodies. For these cases, you can use <code>Param</code> method as in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> baseUrl <span class="token operator">=</span> <span class="token string">&quot;https://myservice.com/products&quot;</span><span class="token punctuation">;</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token comment">// GET https://myservice.com/products?name=iron+chair</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;GetIronChair&quot;</span><span class="token punctuation">,</span> baseUrl<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;iron chair&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment">/*
                * POST https://myservice.com/products
                * Content-Type: application/x-www-form-urlencoded
                * 
                * name=wooden+chair
                */</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;CreateWoodenChair&quot;</span><span class="token punctuation">,</span> baseUrl<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span>HttpMethod<span class="token punctuation">.</span>Post<span class="token punctuation">.</span>Method<span class="token punctuation">)</span> <span class="token comment">// POST </span>
                    <span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wooden chair&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>JMeter automatically URL encodes parameters, so you don&#39;t need to worry about special characters in parameter names or values.</p><p>If you want to use some custom encoding or have an already encoded value that you want to use, then you can use <code>RawParam</code> method instead which does not apply any encoding to the parameter name or value, and send it as is.</p></div><h4 id="headers" tabindex="-1"><a class="header-anchor" href="#headers" aria-hidden="true">#</a> Headers</h4><p>You might have already noticed in some of the examples that we have shown, some ways to set some headers. For instance, in the following snippet, <code>Content-Type</code> header is being set in two different ways:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;field\&quot;:\&quot;val\&quot;}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">ContentType</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>These are handy methods to specify the <code>Content-Type</code> header, but you can also set any header on a particular request using provided <code>Header</code> method, like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;X-First-Header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;val1&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;X-Second-Header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;val2&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally, you can specify headers to be used by all samplers in a test plan, thread group, transaction controllers, etc. For this, you can use <code>HttpHeaders</code> like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">TestPlan</span><span class="token punctuation">(</span>
    <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token function">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;X-Header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;val1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service/users&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="multipart-requests" tabindex="-1"><a class="header-anchor" href="#multipart-requests" aria-hidden="true">#</a> Multipart requests</h4><p>When you need to upload files to an HTTP server or need to send a complex request body, you will in many cases require sending multipart requests. To send a multipart request just use <code>BodyPart</code> and <code>BodyFilePart</code> methods like in the following example:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token keyword">static</span> <span class="token class-name">Abstracta<span class="token punctuation">.</span>JmeterDsl<span class="token punctuation">.</span>JmeterDsl</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>Headers</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mime</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerformanceTest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">TestPlan</span><span class="token punctuation">(</span>
            <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;https://myservice.com/report&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span>HttpMethod<span class="token punctuation">.</span>Post<span class="token punctuation">.</span>Method<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">BodyPart</span><span class="token punctuation">(</span><span class="token string">&quot;myText&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Plain<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">BodyFilePart</span><span class="token punctuation">(</span><span class="token string">&quot;myFile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myReport.xml&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span>MediaTypeNames<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Xml<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="cookies-caching" tabindex="-1"><a class="header-anchor" href="#cookies-caching" aria-hidden="true">#</a> Cookies &amp; caching</h4><p>JMeter DSL automatically adds a cookie manager and cache manager for automatic HTTP cookie and caching handling, emulating a browser behavior. If you need to disable them you can use something like this:</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token function">TestPlan</span><span class="token punctuation">(</span>
    <span class="token function">HttpCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">HttpCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ThreadGroup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token function">HttpSampler</span><span class="token punctuation">(</span><span class="token string">&quot;http://my.service&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="redirects" tabindex="-1"><a class="header-anchor" href="#redirects" aria-hidden="true">#</a> Redirects</h4><p>When JMeter DSL (using JMeter logic) detects a redirection, it will automatically do a request to the redirected URL and register the redirection as a sub-sample of the main request.</p><p>If you want to disable such logic, you can just call <code>.FollowRedirects(false)</code> in a given <code>HttpSampler</code>.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/jmeter-dotnet-dsl/assets/app-1f3162e2.js" defer></script>
  </body>
</html>
